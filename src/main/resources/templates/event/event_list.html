<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="layout">
<th:block layout:fragment="content">
    <div class="wrap">
        <section class="sec2">
            <h2>이벤트 목록</h2>
            <div class="container my-3 event_list">
                <table class="table">
                    <thead class="table-dark">
                    <tr>
                        <th>번호</th>
                        <th style="width:50%">제목</th>
                        <th>글쓴이</th>
                        <th>작성일시</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="event, loop : ${paging}">
                        <td th:text="${paging.getTotalElements - (paging.number * paging.size) - loop.index}"></td>
                        <td>
                            <div class="table_title">
                                <a th:href="@{|/event/detail/${event.id}|}" th:text="${event.subject}"></a>
                                <span class="text-danger small ms-2"
                                      th:if="${#lists.size(event.answerList) > 0}"
                                      th:text="${#lists.size(event.answerList)}">
                            </span>
                            </div>
                        </td>
                        <td>
                            <span th:if="${event.author != null}" th:text="${event.author.userName}"></span>
                        </td>
                        <td th:text="${#temporals.format(event.createDate, 'yyyy-MM-dd')}"></td>
                    </tr>
                    </tbody>
                </table>
                <!-- 페이징처리 시작 -->
                <div th:if="${!paging.isEmpty()}">
                    <ul class="pagination justify-content-center">
                        <li class="page-item" th:classappend="${!paging.hasPrevious} ? 'disabled'">
                            <a class="page-link"
                               th:if="${paging.number>4}" th:href="@{|?page=${paging.number-5}|}">
                                <span>이전</span>
                            </a>
                        </li>
                        <li class="page-item" th:each="page:${#numbers.sequence(startPage, endPage)}"
                            th:classappend="${page == nowPage} ? 'active'">
                            <a th:text="${page}" class="page-link"
                               th:href="@{|?page=${page-1}|}"></a>
                        </li>
                        <li class="page-item" th:classappend="${!paging.hasNext} ? 'disabled'">
                            <a class="page-link" th:href="@{|?page=${endPage}|}">
                                <span>다음</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <a th:href="@{/event/create}" th:if="${#authentication.getPrincipal().getUsername() == 'admin'}" class="btn btn-primary">이벤트 등록하기</a>
                <a th:href="@{/}" class="under-btn btn btn-secondary">메인화면</a>
            </div>
        </section>
    </div>
</th:block>
</html>